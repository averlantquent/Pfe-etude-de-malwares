SRC_DIR := src
OBJ_DIR := obj
INC_DIR := include
BIN_DIR := .

NAME := exploiter
EXEC := $(BIN_DIR)/$(NAME)
SRC := $(wildcard $(SRC_DIR)/*.cpp)
OBJ := $(SRC:$(SRC_DIR)/%.cpp=$(OBJ_DIR)/%.o)
MAK := Makefile
DOX := config
RDM := README.txt

CXX := g++

.PHONY: all clean zip setup

all: $(EXEC)

$(EXEC): $(OBJ) | $(BIN_DIR)
	$(CXX) $^ -o $@

$(OBJ_DIR)/%.o: $(SRC_DIR)/%.cpp | $(OBJ_DIR)
	$(CXX) -c $< -o $@

$(BIN_DIR) $(OBJ_DIR):
	md $@

clean:
	rmdir /s /q $(OBJ_DIR)
	del /s /q $(NAME).zip

zip:
	7z a $(NAME).zip $(SRC_DIR) $(INC_DIR) $(MAK) $(DOX) $(RDM)

setup : all
	doxygen config
	$(NAME).exe setup

# Variables spéciales :
# $@ : Nom de la cible.
# $< : Nom première dépendance.
# $^ : Liste des dépendances.
# $? : Liste des dépencances plus récentes que la cible.
# $* : Nom fichier, sans son extension.